---
title: 记录 C 语言填坑过程
date: 2025-03-10 22:11:49
author: Zhonjc
tags: 
description: 拾起 C 语言，发现其还是有非常多的坑点的
---

## 结构体

1. 在定义一个结构体变量之时，其已经被分配了应有的空间。（实际上，C 语言任何变量在定义时都会自动分配空间）
2. 结构体在定义时可以进行初始化，使用{}，但除了在初始化时可以使用{}赋值外，其余任何时候都不用{}赋值。（实际上，数组也是这样）
3. 结构体数组同样，当进行初始化时，会自动分配整个数组的空间，也可以通过{}嵌套赋值。（也就是说，C 语言数组定义时要么要通过数字显式给出数组长度，要么通过{}进行初始化隐式给出长度，否则会语法错误）
4. 结构体当中如果有数组，那么在定义结构体类型时，是否需要给出数组成员的长度？需要
5. 结构体能否直接通过 A = B 来将B结构体的值赋给A？可以

## 文件

1. 文件定义方式 FILE * fp; fopen(path, mode)/fclose(FILE *) mode 包含 r/w/a/b
2. 文件读取方法
	1. 按字符 fgetc(fp) 返回字符，结尾 EOF
	2. 按行 fgets(buffer, buffer_l, fp)，读入 buffer，通过 feof(fp)来检测文件尾，每行 buffer 从头写。fgets 当文件尾和出错时都会返回 NULL。固定写法：
		` while(!feof(fp)){if(fgets(…) != NULL){}} `
	3. 按格式 fscanf(fp, “format”, aim)返回读取项数

3. 文件写入方法
	1. 按字符 fputc(char, fp) 
	2. 按行 fputs(string, fp)
	3. 按格式 fprintf(fp, format, src)

## 数组

1. 任何类型的数组，只有在定义时才能通过{}进行赋值（初始化）。
2. 任何类型的数组，在定义时必须显式或隐式的给出数组长度，不可以不给出。
3. 任何类型的数组在定义时便会分配好空间，后续无需再次分配。
4. 数组名，本质上是一种指针常量，其不是普通的指针，不可以被赋值。切记不要把值赋给一个数组名，尤其是字符数组构成的字符串特别容易写错。
5. 对于数组名 A，A\[i]是值，A 是地址，可以有 A+1 来指向下一个值，但 A 本身的值无法更改，不可以 A++。

## 字符串

1. C 语言中的字符串本质上就是一个字符数组。
2. 赋值方式：
	1. 定义时（初始化时），可以直接赋值。char A[] = "This is a String"; char B[] = {'H', 'I', '\0'}; 
	2. 除了定义时，其余任何时候，都不能通过数组名来直接赋值。
	3. 那么如何赋值？通常使用 strcpy(dest, str);
3. C 语言字符串的最后必须包含一个隐藏的 '\0' 作为字符串的末尾标识。在通过{}定义字符数组时如果没加，则在使用字符串相关函数时会可能溢出数组。
4. 为什么字符串本质上作为一种字符数组可以在printf中直接通过传入数组名来输出呢？其他类型数组不行。因为 %s 要接收的类型就是 char *，而字符数组名在传入函数时会退化为指针，因此可以传入。
5. 千万别忘C 语言任何字符串的最后都有一个 '\0'，在定义字符数组长度时千万要注意！例如名字最多有 4 个字，但是字符数组必须长度为 5，例如学号固定长度 10 位，字符数组必须长度为 11。
6. 注意，C 语言中，char 类型只占 1 字节，这根本不够存储中文字符，在 UTF-8 下每个字符长达 3 字节。因此，在 C 语言中，中文字符不能用单个 char 来存储。同理，在字符数组构成的字符串中，如果该字符串要存储中文，切记不要把长度设定为要存储的中文长度，否则会超界。应该设为长度*3+1。

## 指针

1. 虽然数组名是一种特殊的指针常量，其包含一些数组信息，可以通过 sizeof(A)来获得整个数组的空间大小。但是，如果数组名传入函数当中，其会退化为普通指针，其不再包含数组信息，sizeof 只会获得指针本身的空间大小。（sizeof函数不会触发退化）

## 运算

1. int/int会截断小数部分。
2. 如果想得到精确运算，将其中一个操作数进行类型转换。(float)int.